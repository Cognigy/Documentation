---
title: "4.81"
slug: "4.81"
hidden: false
---

# 4.81

{! _includes/release-notes/upcoming-feature-removals-4.79.md !}

!!! warning "Security Changes and their Impact"
    - While addressing security vulnerabilities, changes in third-party vocabularies may cause some exact matching cases to fail, but conversations should continue uninterrupted. Re-training the model will resolve exact matching issues. If persistent errors occur, contact [Cognigy technical support](../help/get-help.md).
    - While addressing security vulnerabilities, changes in third-party vocabularies may cause slight variations in tokenization for certain locales. For example, in French, hyphens may now be included as part of suffixes in tokens. Variations in token outputs are expected. If you encounter any significant issues, contact [Cognigy technical support](../help/get-help.md).

{! _includes/release-notes/resolve-llm-connection-error.md !}

## 4.81.0

### Cognigy.AI

**Released** July 23rd, 2024

#### Improvements

- Added the Stream Buffer Flush Tokens and Stream Buffer Flush Overrides options to the [Storage and Streaming](../ai/build/node-reference/service/llm-prompt.md#storage-and-streaming-options) in the LLM Prompt Node
- Added the [Enable input sanitization](../ai/deploy/endpoints/data-protection-and-analytics.md#enable-input-sanitization) option to disable HTML text input sanitization within the Endpoint Settings 
- Removed the `New` badge from the Knowledge AI sidebar and Knowledge Stores page 
- Added a tooltip with the full name for long Flow names in the Flow select field 
- Fetched the trainer records from the secondary MongoDB replica, which can be disabled to read from the primary by setting the environment variable `DISABLE_SECONDARY_MONGO_REPLICA_READ_TRAINER` 
- Made duplicate trainer record removal configurable with the `DISABLE_DUPLICATE_TRAINER_RECORD_REMOVAL` environment variable. This operation, which can be performance-intensive, can now be disabled on demand 
- Redesigned the Cognigy.AI sidebar 
- Removed the Cognigy.AI Journeys API
- Improved by preselecting the current flow in the Case Nodes of the Lookup Node 
- Changed the styles of Cancel buttons in sidebars
- Added German localization to the product

#### Bugfixes

- Fixed the issue where the Intent description an attached Flow's Intent was missing in the NLU inference results 
- Fixed the issue where the Endpoint editor had problems with saving because of the default value of Enable Quick Replies 
- Fixed the issue where an incorrect tooltip text was shown in the Knowledge AI Settings section under Document Processing > Connection to Azure AI Document Intelligence  
- Fixed the issue where the Voice Preview feature was not working because of a missing Content Security Policy directive 
- Fixed the issue where the Cognigy logo couldn't be seen in the Create Project page 
- Fixed the issue where `knowledgeSourceUrl` could be set incorrectly during the Knowledge AI package import and vector database restore operations

### Cognigy Voice Gateway

**Released** July 23rd, 2024

#### Improvements

- Improved by supporting complex `refer-to` and `referred-by` URI
- Added new metrics to track the duration of Voice Gateway commands
- Added the Enable User No Input Timeout option in the Set Session Config Node to enable or disable the User no Input timeout feature

#### Bugfixes

- Fixed the issue where the `Contact` header in the `200 OK (INVITE)` response used the `sips` scheme instead of `sip`
- Fixed the issue where the `Contact` header did not contain the private IP on a private CIDR
- Fixed the issue where the `Contact` header in a re-INVITE request had the wrong scheme 
- Fixed the issue where users with the Service Provider role were unable to delete an account phone number 
- Fixed the issue where escape characters like `"\r"`, `"\t"`,  `"\n"` in a text lead to invalid SSML when Azure streaming was enabled 
- Fixed the issue where using the `inject` API failed when the sessionId was changed through the input transformer. Before 4.81, we stored the Voice Gateway client based on the callSid. The Voice Gateway client is now stored based on the sessionId 
- Fixed the issue where no event was sent after a successful `Refer` transfer with the reason `Gone` 
- Fixed the issue where an error occurred after hangup when the `ENDPOINT_VG2_TIMEOUT_FOR_AI_RESPONSES_IN_SECONDS` environment variable was set 
- Fixed the issue where a timeout was triggered when a message was sent to AI Agent. In some scenarios, no answer is expected. The solution for now is to only trigger the timeout when an environment variable specifying the timeout period is set 

### Cognigy Webchat

**Released** July 23rd, 2024

#### Features

- Added the [Collect Metadata](../webchat/v3/metadata.md) option to the Webchat v3 Endpoint Settings. This option lets you gather additional metadata from user browsers

#### Improvements

- Updated Webchat v3 version to v3.0.0.0-beta.31
- Added the [Enable text-to-speech option](../webchat/v3/features.md#text-to-speech) option to the Chat Options settings section within the Webchat v3 Endpoint Settings

### Cognigy Insights

**Released** July 23rd, 2024

#### Improvements

- Improved by renaming `Additional Filters` panel to `More Filters` 
- Improved by adding a new REST API endpoint `/v2.0/error-messages` which enables retrieval of error messages filtered by query parameters 

#### Bugfixes

- Fixed the issue where the analytics data were not inserted into MongoDB if any key in the data began with `$` 
- Fixed the issue where conversations data were not inserted into MongoDB if any key in the data began with `$`

### Infrastructure

#### Cognigy Voice Gateway

- Updated `vg-freeswitch-mrf` to `0.9.1`
- Added new environment variable `AZURE_SPEECH_USE_SINGLE_CONNECTION` to `feature-server` Deployment and StatefulSet - container `freeswitch`. It can be controlled via `.Values.freeswitch.azureSttUseSingleConnection` default value is `true` 
- Changed the freeSWITCH `.Values.freeswitch.bufferSecs` default value to `5` seconds

#### Rollback Instructions

In case you need to revert to version 4.80.1, run the following script since we've added a new field for the Endpoints (!31158).

1. Establish a connection to the MongoDB instance within your cluster and execute the database script:

    ```bash
    kubectl exec -it -n mongodb mongodb-0 -- bash
    mongo -u $MONGODB_ROOT_USER -p $MONGODB_ROOT_PASSWORD --authenticationDatabase admin

    use service-resources;
    db.endpoints.updateMany({},{$unset:{"settings.behavior.enableCollectMetadata":""}});
    ```

2. Execute the Helm Chart rollback.
  
#### Version Compatibility Matrix

The version compatibility matrix was updated for the following Cognigy products:

- [Cognigy.AI, Insights, and AI Copilot](../ai/installation/version-compatibility-matrix.md)
- [Live Agent](../live-agent/installation/deployment/version-compatibility-matrix.md)
- [Cognigy Voice Gateway](../voice-gateway/installation/version-compatibility-matrix.md)